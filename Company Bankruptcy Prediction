{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/cyrogai/98-acc-company-bankruptcy-prediction?scriptVersionId=180791904\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"1533ba2d","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2024-05-31T15:53:19.08907Z","iopub.status.busy":"2024-05-31T15:53:19.08861Z","iopub.status.idle":"2024-05-31T15:53:21.694301Z","shell.execute_reply":"2024-05-31T15:53:21.693062Z"},"papermill":{"duration":2.616001,"end_time":"2024-05-31T15:53:21.697417","exception":false,"start_time":"2024-05-31T15:53:19.081416","status":"completed"},"tags":[]},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import sklearn\n","from sklearn import linear_model\n","from sklearn.utils import shuffle"]},{"cell_type":"code","execution_count":2,"id":"9ff425f5","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:21.71076Z","iopub.status.busy":"2024-05-31T15:53:21.710025Z","iopub.status.idle":"2024-05-31T15:53:22.060077Z","shell.execute_reply":"2024-05-31T15:53:22.058721Z"},"papermill":{"duration":0.360702,"end_time":"2024-05-31T15:53:22.063496","exception":false,"start_time":"2024-05-31T15:53:21.702794","status":"completed"},"tags":[]},"outputs":[],"source":["data= pd.read_csv(\"/kaggle/input/company-bankruptcy-prediction/data.csv\")"]},{"cell_type":"code","execution_count":3,"id":"87850b9f","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.076726Z","iopub.status.busy":"2024-05-31T15:53:22.075504Z","iopub.status.idle":"2024-05-31T15:53:22.119949Z","shell.execute_reply":"2024-05-31T15:53:22.118774Z"},"papermill":{"duration":0.054572,"end_time":"2024-05-31T15:53:22.123373","exception":false,"start_time":"2024-05-31T15:53:22.068801","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Bankrupt?</th>\n","      <th>ROA(C) before interest and depreciation before interest</th>\n","      <th>ROA(A) before interest and % after tax</th>\n","      <th>ROA(B) before interest and depreciation after tax</th>\n","      <th>Operating Gross Margin</th>\n","      <th>Realized Sales Gross Margin</th>\n","      <th>Operating Profit Rate</th>\n","      <th>Pre-tax net Interest Rate</th>\n","      <th>After-tax net Interest Rate</th>\n","      <th>Non-industry income and expenditure/revenue</th>\n","      <th>...</th>\n","      <th>Net Income to Total Assets</th>\n","      <th>Total assets to GNP price</th>\n","      <th>No-credit Interval</th>\n","      <th>Gross Profit to Sales</th>\n","      <th>Net Income to Stockholder's Equity</th>\n","      <th>Liability to Equity</th>\n","      <th>Degree of Financial Leverage (DFL)</th>\n","      <th>Interest Coverage Ratio (Interest expense to EBIT)</th>\n","      <th>Net Income Flag</th>\n","      <th>Equity to Liability</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.370594</td>\n","      <td>0.424389</td>\n","      <td>0.405750</td>\n","      <td>0.601457</td>\n","      <td>0.601457</td>\n","      <td>0.998969</td>\n","      <td>0.796887</td>\n","      <td>0.808809</td>\n","      <td>0.302646</td>\n","      <td>...</td>\n","      <td>0.716845</td>\n","      <td>0.009219</td>\n","      <td>0.622879</td>\n","      <td>0.601453</td>\n","      <td>0.827890</td>\n","      <td>0.290202</td>\n","      <td>0.026601</td>\n","      <td>0.564050</td>\n","      <td>1</td>\n","      <td>0.016469</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>0.464291</td>\n","      <td>0.538214</td>\n","      <td>0.516730</td>\n","      <td>0.610235</td>\n","      <td>0.610235</td>\n","      <td>0.998946</td>\n","      <td>0.797380</td>\n","      <td>0.809301</td>\n","      <td>0.303556</td>\n","      <td>...</td>\n","      <td>0.795297</td>\n","      <td>0.008323</td>\n","      <td>0.623652</td>\n","      <td>0.610237</td>\n","      <td>0.839969</td>\n","      <td>0.283846</td>\n","      <td>0.264577</td>\n","      <td>0.570175</td>\n","      <td>1</td>\n","      <td>0.020794</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>0.426071</td>\n","      <td>0.499019</td>\n","      <td>0.472295</td>\n","      <td>0.601450</td>\n","      <td>0.601364</td>\n","      <td>0.998857</td>\n","      <td>0.796403</td>\n","      <td>0.808388</td>\n","      <td>0.302035</td>\n","      <td>...</td>\n","      <td>0.774670</td>\n","      <td>0.040003</td>\n","      <td>0.623841</td>\n","      <td>0.601449</td>\n","      <td>0.836774</td>\n","      <td>0.290189</td>\n","      <td>0.026555</td>\n","      <td>0.563706</td>\n","      <td>1</td>\n","      <td>0.016474</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>0.399844</td>\n","      <td>0.451265</td>\n","      <td>0.457733</td>\n","      <td>0.583541</td>\n","      <td>0.583541</td>\n","      <td>0.998700</td>\n","      <td>0.796967</td>\n","      <td>0.808966</td>\n","      <td>0.303350</td>\n","      <td>...</td>\n","      <td>0.739555</td>\n","      <td>0.003252</td>\n","      <td>0.622929</td>\n","      <td>0.583538</td>\n","      <td>0.834697</td>\n","      <td>0.281721</td>\n","      <td>0.026697</td>\n","      <td>0.564663</td>\n","      <td>1</td>\n","      <td>0.023982</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>0.465022</td>\n","      <td>0.538432</td>\n","      <td>0.522298</td>\n","      <td>0.598783</td>\n","      <td>0.598783</td>\n","      <td>0.998973</td>\n","      <td>0.797366</td>\n","      <td>0.809304</td>\n","      <td>0.303475</td>\n","      <td>...</td>\n","      <td>0.795016</td>\n","      <td>0.003878</td>\n","      <td>0.623521</td>\n","      <td>0.598782</td>\n","      <td>0.839973</td>\n","      <td>0.278514</td>\n","      <td>0.024752</td>\n","      <td>0.575617</td>\n","      <td>1</td>\n","      <td>0.035490</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 96 columns</p>\n","</div>"],"text/plain":["   Bankrupt?   ROA(C) before interest and depreciation before interest  \\\n","0          1                                           0.370594          \n","1          1                                           0.464291          \n","2          1                                           0.426071          \n","3          1                                           0.399844          \n","4          1                                           0.465022          \n","\n","    ROA(A) before interest and % after tax  \\\n","0                                 0.424389   \n","1                                 0.538214   \n","2                                 0.499019   \n","3                                 0.451265   \n","4                                 0.538432   \n","\n","    ROA(B) before interest and depreciation after tax  \\\n","0                                           0.405750    \n","1                                           0.516730    \n","2                                           0.472295    \n","3                                           0.457733    \n","4                                           0.522298    \n","\n","    Operating Gross Margin   Realized Sales Gross Margin  \\\n","0                 0.601457                      0.601457   \n","1                 0.610235                      0.610235   \n","2                 0.601450                      0.601364   \n","3                 0.583541                      0.583541   \n","4                 0.598783                      0.598783   \n","\n","    Operating Profit Rate   Pre-tax net Interest Rate  \\\n","0                0.998969                    0.796887   \n","1                0.998946                    0.797380   \n","2                0.998857                    0.796403   \n","3                0.998700                    0.796967   \n","4                0.998973                    0.797366   \n","\n","    After-tax net Interest Rate   Non-industry income and expenditure/revenue  \\\n","0                      0.808809                                      0.302646   \n","1                      0.809301                                      0.303556   \n","2                      0.808388                                      0.302035   \n","3                      0.808966                                      0.303350   \n","4                      0.809304                                      0.303475   \n","\n","   ...   Net Income to Total Assets   Total assets to GNP price  \\\n","0  ...                     0.716845                    0.009219   \n","1  ...                     0.795297                    0.008323   \n","2  ...                     0.774670                    0.040003   \n","3  ...                     0.739555                    0.003252   \n","4  ...                     0.795016                    0.003878   \n","\n","    No-credit Interval   Gross Profit to Sales  \\\n","0             0.622879                0.601453   \n","1             0.623652                0.610237   \n","2             0.623841                0.601449   \n","3             0.622929                0.583538   \n","4             0.623521                0.598782   \n","\n","    Net Income to Stockholder's Equity   Liability to Equity  \\\n","0                             0.827890              0.290202   \n","1                             0.839969              0.283846   \n","2                             0.836774              0.290189   \n","3                             0.834697              0.281721   \n","4                             0.839973              0.278514   \n","\n","    Degree of Financial Leverage (DFL)  \\\n","0                             0.026601   \n","1                             0.264577   \n","2                             0.026555   \n","3                             0.026697   \n","4                             0.024752   \n","\n","    Interest Coverage Ratio (Interest expense to EBIT)   Net Income Flag  \\\n","0                                           0.564050                   1   \n","1                                           0.570175                   1   \n","2                                           0.563706                   1   \n","3                                           0.564663                   1   \n","4                                           0.575617                   1   \n","\n","    Equity to Liability  \n","0              0.016469  \n","1              0.020794  \n","2              0.016474  \n","3              0.023982  \n","4              0.035490  \n","\n","[5 rows x 96 columns]"]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["data.head()"]},{"cell_type":"code","execution_count":4,"id":"016bd269","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.136348Z","iopub.status.busy":"2024-05-31T15:53:22.135909Z","iopub.status.idle":"2024-05-31T15:53:22.169754Z","shell.execute_reply":"2024-05-31T15:53:22.168325Z"},"papermill":{"duration":0.043758,"end_time":"2024-05-31T15:53:22.172838","exception":false,"start_time":"2024-05-31T15:53:22.12908","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Bankrupt?</th>\n","      <th>ROA(C) before interest and depreciation before interest</th>\n","      <th>ROA(A) before interest and % after tax</th>\n","      <th>ROA(B) before interest and depreciation after tax</th>\n","      <th>Operating Gross Margin</th>\n","      <th>Realized Sales Gross Margin</th>\n","      <th>Operating Profit Rate</th>\n","      <th>Pre-tax net Interest Rate</th>\n","      <th>After-tax net Interest Rate</th>\n","      <th>Non-industry income and expenditure/revenue</th>\n","      <th>...</th>\n","      <th>Net Income to Total Assets</th>\n","      <th>Total assets to GNP price</th>\n","      <th>No-credit Interval</th>\n","      <th>Gross Profit to Sales</th>\n","      <th>Net Income to Stockholder's Equity</th>\n","      <th>Liability to Equity</th>\n","      <th>Degree of Financial Leverage (DFL)</th>\n","      <th>Interest Coverage Ratio (Interest expense to EBIT)</th>\n","      <th>Net Income Flag</th>\n","      <th>Equity to Liability</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>6814</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>6815</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>6816</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>6817</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>6818</th>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>...</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>False</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>6819 rows Ã— 96 columns</p>\n","</div>"],"text/plain":["      Bankrupt?   ROA(C) before interest and depreciation before interest  \\\n","0         False                                              False          \n","1         False                                              False          \n","2         False                                              False          \n","3         False                                              False          \n","4         False                                              False          \n","...         ...                                                ...          \n","6814      False                                              False          \n","6815      False                                              False          \n","6816      False                                              False          \n","6817      False                                              False          \n","6818      False                                              False          \n","\n","       ROA(A) before interest and % after tax  \\\n","0                                       False   \n","1                                       False   \n","2                                       False   \n","3                                       False   \n","4                                       False   \n","...                                       ...   \n","6814                                    False   \n","6815                                    False   \n","6816                                    False   \n","6817                                    False   \n","6818                                    False   \n","\n","       ROA(B) before interest and depreciation after tax  \\\n","0                                                 False    \n","1                                                 False    \n","2                                                 False    \n","3                                                 False    \n","4                                                 False    \n","...                                                 ...    \n","6814                                              False    \n","6815                                              False    \n","6816                                              False    \n","6817                                              False    \n","6818                                              False    \n","\n","       Operating Gross Margin   Realized Sales Gross Margin  \\\n","0                       False                         False   \n","1                       False                         False   \n","2                       False                         False   \n","3                       False                         False   \n","4                       False                         False   \n","...                       ...                           ...   \n","6814                    False                         False   \n","6815                    False                         False   \n","6816                    False                         False   \n","6817                    False                         False   \n","6818                    False                         False   \n","\n","       Operating Profit Rate   Pre-tax net Interest Rate  \\\n","0                      False                       False   \n","1                      False                       False   \n","2                      False                       False   \n","3                      False                       False   \n","4                      False                       False   \n","...                      ...                         ...   \n","6814                   False                       False   \n","6815                   False                       False   \n","6816                   False                       False   \n","6817                   False                       False   \n","6818                   False                       False   \n","\n","       After-tax net Interest Rate  \\\n","0                            False   \n","1                            False   \n","2                            False   \n","3                            False   \n","4                            False   \n","...                            ...   \n","6814                         False   \n","6815                         False   \n","6816                         False   \n","6817                         False   \n","6818                         False   \n","\n","       Non-industry income and expenditure/revenue  ...  \\\n","0                                            False  ...   \n","1                                            False  ...   \n","2                                            False  ...   \n","3                                            False  ...   \n","4                                            False  ...   \n","...                                            ...  ...   \n","6814                                         False  ...   \n","6815                                         False  ...   \n","6816                                         False  ...   \n","6817                                         False  ...   \n","6818                                         False  ...   \n","\n","       Net Income to Total Assets   Total assets to GNP price  \\\n","0                           False                       False   \n","1                           False                       False   \n","2                           False                       False   \n","3                           False                       False   \n","4                           False                       False   \n","...                           ...                         ...   \n","6814                        False                       False   \n","6815                        False                       False   \n","6816                        False                       False   \n","6817                        False                       False   \n","6818                        False                       False   \n","\n","       No-credit Interval   Gross Profit to Sales  \\\n","0                   False                   False   \n","1                   False                   False   \n","2                   False                   False   \n","3                   False                   False   \n","4                   False                   False   \n","...                   ...                     ...   \n","6814                False                   False   \n","6815                False                   False   \n","6816                False                   False   \n","6817                False                   False   \n","6818                False                   False   \n","\n","       Net Income to Stockholder's Equity   Liability to Equity  \\\n","0                                   False                 False   \n","1                                   False                 False   \n","2                                   False                 False   \n","3                                   False                 False   \n","4                                   False                 False   \n","...                                   ...                   ...   \n","6814                                False                 False   \n","6815                                False                 False   \n","6816                                False                 False   \n","6817                                False                 False   \n","6818                                False                 False   \n","\n","       Degree of Financial Leverage (DFL)  \\\n","0                                   False   \n","1                                   False   \n","2                                   False   \n","3                                   False   \n","4                                   False   \n","...                                   ...   \n","6814                                False   \n","6815                                False   \n","6816                                False   \n","6817                                False   \n","6818                                False   \n","\n","       Interest Coverage Ratio (Interest expense to EBIT)   Net Income Flag  \\\n","0                                                 False               False   \n","1                                                 False               False   \n","2                                                 False               False   \n","3                                                 False               False   \n","4                                                 False               False   \n","...                                                 ...                 ...   \n","6814                                              False               False   \n","6815                                              False               False   \n","6816                                              False               False   \n","6817                                              False               False   \n","6818                                              False               False   \n","\n","       Equity to Liability  \n","0                    False  \n","1                    False  \n","2                    False  \n","3                    False  \n","4                    False  \n","...                    ...  \n","6814                 False  \n","6815                 False  \n","6816                 False  \n","6817                 False  \n","6818                 False  \n","\n","[6819 rows x 96 columns]"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["data.isnull()"]},{"cell_type":"code","execution_count":5,"id":"13f88d03","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.188244Z","iopub.status.busy":"2024-05-31T15:53:22.187775Z","iopub.status.idle":"2024-05-31T15:53:22.213018Z","shell.execute_reply":"2024-05-31T15:53:22.211504Z"},"papermill":{"duration":0.036976,"end_time":"2024-05-31T15:53:22.21634","exception":false,"start_time":"2024-05-31T15:53:22.179364","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["   Bankrupt?  ROA(C) before interest and depreciation before interest  \\\n","0          0                                                1.1         \n","1          1                                                2.2         \n","2          0                                                3.3         \n","\n","   ROA(A) before interest and % after tax  \\\n","0                                     1.0   \n","1                                     2.0   \n","2                                     3.0   \n","\n","   ROA(B) before interest and depreciation after tax  Operating Gross Margin  \\\n","0                                                0.9                      30   \n","1                                                1.9                      35   \n","2                                                2.9                      32   \n","\n","   Realized Sales Gross Margin  Pre-tax net Interest Rate  \\\n","0                           28                          5   \n","1                           34                          6   \n","2                           31                          5   \n","\n","   After-tax net Interest Rate  Non-industry income and expenditure/revenue  \\\n","0                            4                                          0.1   \n","1                            5                                          0.2   \n","2                            4                                          0.3   \n","\n","   Net Income to Total Assets  Total assets to GNP price  No-credit Interval  \\\n","0                          10                        100                 200   \n","1                          15                        150                 250   \n","2                          12                        120                 220   \n","\n","   Gross Profit to Sales  Net Income to Stockholder's Equity  \\\n","0                     40                                  12   \n","1                     45                                  17   \n","2                     42                                  14   \n","\n","   Liability to Equity  Degree of Financial Leverage (DFL)  \\\n","0                  1.5                                 1.2   \n","1                  1.8                                 1.3   \n","2                  1.6                                 1.4   \n","\n","   Interest Coverage Ratio (Interest expense to EBIT)  Net Income Flag  \\\n","0                                                3.0                 1   \n","1                                                4.0                 0   \n","2                                                3.5                 1   \n","\n","   Equity to Liability  \n","0                 0.80  \n","1                 0.85  \n","2                 0.82  \n"]}],"source":["import pandas as pd\n","\n","# Example DataFrame (replace this with your actual data loading method)\n","data = pd.DataFrame({\n","    \"Bankrupt?\": [0, 1, 0],\n","    \"ROA(C) before interest and depreciation before interest \": [1.1, 2.2, 3.3],\n","    \"ROA(A) before interest and % after tax\": [1.0, 2.0, 3.0],\n","    \"ROA(B) before interest and depreciation after tax\": [0.9, 1.9, 2.9],\n","    \"Operating Gross Margin\": [30, 35, 32],\n","    \"Realized Sales Gross Margin\": [28, 34, 31],\n","    \"Pre-tax net Interest Rate\": [5, 6, 5],\n","    \"After-tax net Interest Rate\": [4, 5, 4],\n","    \"Non-industry income and expenditure/revenue\": [0.1, 0.2, 0.3],\n","    \"Net Income to Total Assets\": [10, 15, 12],\n","    \"Total assets to GNP price\": [100, 150, 120],\n","    \"No-credit Interval\": [200, 250, 220],\n","    \"Gross Profit to Sales\": [40, 45, 42],\n","    \"Net Income to Stockholder's Equity\": [12, 17, 14],\n","    \"Liability to Equity\": [1.5, 1.8, 1.6],\n","    \"Degree of Financial Leverage (DFL)\": [1.2, 1.3, 1.4],\n","    \"Interest Coverage Ratio (Interest expense to EBIT)\": [3, 4, 3.5],\n","    \"Net Income Flag\": [1, 0, 1],\n","    \"Equity to Liability\": [0.8, 0.85, 0.82]\n","})\n","\n","# Clean up column names\n","data.columns = data.columns.str.strip()\n","\n","# Columns to retain\n","retain = [\n","    \"Bankrupt?\", \"ROA(C) before interest and depreciation before interest\",\n","    \"ROA(A) before interest and % after tax\", \"ROA(B) before interest and depreciation after tax\",\n","    \"Operating Gross Margin\",\"Realized Sales Gross Margin\", \"Pre-tax net Interest Rate\", \n","    \"After-tax net Interest Rate\", \"Non-industry income and expenditure/revenue\", \"Net Income to Total Assets\", \n","    \"Total assets to GNP price\", \"No-credit Interval\", \"Gross Profit to Sales\", \n","    \"Net Income to Stockholder's Equity\", \"Liability to Equity\", \"Degree of Financial Leverage (DFL)\", \n","    \"Interest Coverage Ratio (Interest expense to EBIT)\",\"Net Income Flag\", \"Equity to Liability\"\n","]\n","\n","# Ensure there are no leading/trailing spaces in the retain list items\n","retain = [col.strip() for col in retain]\n","\n","# Retain only the specified columns\n","data_filtered = data.loc[:, retain]\n","\n","# Print the filtered DataFrame\n","print(data_filtered)\n"]},{"cell_type":"code","execution_count":6,"id":"e5c745f9","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.231223Z","iopub.status.busy":"2024-05-31T15:53:22.230729Z","iopub.status.idle":"2024-05-31T15:53:22.238827Z","shell.execute_reply":"2024-05-31T15:53:22.237522Z"},"papermill":{"duration":0.018528,"end_time":"2024-05-31T15:53:22.241358","exception":false,"start_time":"2024-05-31T15:53:22.22283","status":"completed"},"tags":[]},"outputs":[],"source":["\n","x = np.array(data.drop(['Bankrupt?'], axis = 1))\n","\n","y = np.array(data['Bankrupt?'])"]},{"cell_type":"code","execution_count":7,"id":"363b743a","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.256285Z","iopub.status.busy":"2024-05-31T15:53:22.255823Z","iopub.status.idle":"2024-05-31T15:53:22.264827Z","shell.execute_reply":"2024-05-31T15:53:22.263208Z"},"papermill":{"duration":0.020164,"end_time":"2024-05-31T15:53:22.267806","exception":false,"start_time":"2024-05-31T15:53:22.247642","status":"completed"},"tags":[]},"outputs":[],"source":["x_train,x_test, y_train, y_test = sklearn.model_selection.train_test_split(x,y, test_size = 0.2 , random_state = 2) \n"]},{"cell_type":"markdown","id":"98c7ddee","metadata":{"papermill":{"duration":0.005987,"end_time":"2024-05-31T15:53:22.280411","exception":false,"start_time":"2024-05-31T15:53:22.274424","status":"completed"},"tags":[]},"source":[]},{"cell_type":"code","execution_count":8,"id":"0f9ac38f","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.295507Z","iopub.status.busy":"2024-05-31T15:53:22.295051Z","iopub.status.idle":"2024-05-31T15:53:22.300967Z","shell.execute_reply":"2024-05-31T15:53:22.299754Z"},"papermill":{"duration":0.016777,"end_time":"2024-05-31T15:53:22.303827","exception":false,"start_time":"2024-05-31T15:53:22.28705","status":"completed"},"tags":[]},"outputs":[],"source":["linear = linear_model.LinearRegression()"]},{"cell_type":"code","execution_count":9,"id":"79fa7345","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.320085Z","iopub.status.busy":"2024-05-31T15:53:22.319543Z","iopub.status.idle":"2024-05-31T15:53:22.354106Z","shell.execute_reply":"2024-05-31T15:53:22.352705Z"},"papermill":{"duration":0.04659,"end_time":"2024-05-31T15:53:22.357547","exception":false,"start_time":"2024-05-31T15:53:22.310957","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"â–¸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"â–¾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearRegression</label><div class=\"sk-toggleable__content\"><pre>LinearRegression()</pre></div></div></div></div></div>"],"text/plain":["LinearRegression()"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["linear.fit(x_train, y_train)"]},{"cell_type":"code","execution_count":10,"id":"621b6c80","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.372517Z","iopub.status.busy":"2024-05-31T15:53:22.372053Z","iopub.status.idle":"2024-05-31T15:53:22.382127Z","shell.execute_reply":"2024-05-31T15:53:22.380803Z"},"papermill":{"duration":0.021054,"end_time":"2024-05-31T15:53:22.385104","exception":false,"start_time":"2024-05-31T15:53:22.36405","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_regression.py:918: UndefinedMetricWarning: R^2 score is not well-defined with less than two samples.\n","  warnings.warn(msg, UndefinedMetricWarning)\n"]}],"source":["acc = linear.score(x_test,y_test)"]},{"cell_type":"code","execution_count":11,"id":"d0ab3f1e","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.400642Z","iopub.status.busy":"2024-05-31T15:53:22.400141Z","iopub.status.idle":"2024-05-31T15:53:22.407857Z","shell.execute_reply":"2024-05-31T15:53:22.406656Z"},"papermill":{"duration":0.018443,"end_time":"2024-05-31T15:53:22.410345","exception":false,"start_time":"2024-05-31T15:53:22.391902","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["nan"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["acc"]},{"cell_type":"code","execution_count":12,"id":"4c89f510","metadata":{"execution":{"iopub.execute_input":"2024-05-31T15:53:22.42586Z","iopub.status.busy":"2024-05-31T15:53:22.425264Z","iopub.status.idle":"2024-05-31T15:53:22.434276Z","shell.execute_reply":"2024-05-31T15:53:22.432994Z"},"papermill":{"duration":0.019977,"end_time":"2024-05-31T15:53:22.436955","exception":false,"start_time":"2024-05-31T15:53:22.416978","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[-2.04572628]\n","predictions are:  -2.0457262790734965\n"]}],"source":["#input = ((0.424389,0.405750,0.601457,0.601457,0.998969,0.796887,0.808809,0.302646,0.716845,0.009219,0.622879,0.601453,0.827890,0.290202,0.026601,0.564050,1,0.016469))\n","\n","input = ((0,1,2,3,4,5,6,7,8,9,90,8,7,6,4,0,0,0))\n","\n","input_array = np.asarray(input)\n","\n","input_array_reshape = input_array.reshape(1, -1)\n","\n","predictions = linear.predict(input_array_reshape)\n","print (predictions)\n","\n","print(\"predictions are: \", predictions[0])"]},{"cell_type":"code","execution_count":null,"id":"b5e6e4af","metadata":{"papermill":{"duration":0.006236,"end_time":"2024-05-31T15:53:22.450083","exception":false,"start_time":"2024-05-31T15:53:22.443847","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"150604ae","metadata":{"papermill":{"duration":0.00669,"end_time":"2024-05-31T15:53:22.46402","exception":false,"start_time":"2024-05-31T15:53:22.45733","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"6e2820d8","metadata":{"papermill":{"duration":0.006752,"end_time":"2024-05-31T15:53:22.477453","exception":false,"start_time":"2024-05-31T15:53:22.470701","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"dc6b4ea0","metadata":{"papermill":{"duration":0.007048,"end_time":"2024-05-31T15:53:22.491337","exception":false,"start_time":"2024-05-31T15:53:22.484289","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":1111894,"sourceId":1938459,"sourceType":"datasetVersion"}],"dockerImageVersionId":30715,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":7.458876,"end_time":"2024-05-31T15:53:23.322261","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-05-31T15:53:15.863385","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}